<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Thomas Lehmann &lt;thomas.lehmann.private@gmail.com" name="author"/>
<link href="https://thomas-lehmann-private.github.io/hyperion-task-processor/docker-container/" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Docker container task - Hyperion Task Processor</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/docco.min.css" rel="stylesheet"/>
<script defer="" src="../js/jquery-1.10.2.min.js"></script>
<script defer="" src="../js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
<div class="container">
<a class="navbar-brand" href="..">Hyperion Task Processor</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href="..">Home</a>
</li>
<li class="dropdown active">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">User Guide <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../hyperion-task-processor/">Application</a>
</li>
<li>
<a class="dropdown-item" href="../taskgroup/">Taskgroup</a>
</li>
<li>
<a class="dropdown-item" href="../basic-task-features/">Basic tasks features</a>
</li>
<li>
<a class="dropdown-item" href="../basic-coded-task-features/">Basic code tasks</a>
</li>
<li>
<a class="dropdown-item" href="../groovy/">Groovy task</a>
</li>
<li>
<a class="dropdown-item" href="../powershell/">Powershell task</a>
</li>
<li>
<a class="dropdown-item" href="../windows-batch/">Windows Batch task</a>
</li>
<li>
<a class="dropdown-item" href="../shell/">Shell task</a>
</li>
<li>
<a class="dropdown-item" href="../docker-image/">Docker image task</a>
</li>
<li>
<a class="dropdown-item active" href="./">Docker container task</a>
</li>
<li>
<a class="dropdown-item" href="../copy-file/">File copy task</a>
</li>
<li>
<a class="dropdown-item" href="../write-file/">Write File Task</a>
</li>
<li>
<a class="dropdown-item" href="../download-task/">Download Task</a>
</li>
<li>
<a class="dropdown-item" href="../xsl-transform/">XSL Transform Task</a>
</li>
<li>
<a class="dropdown-item" href="../templating/">Templating</a>
</li>
<li>
<a class="dropdown-item" href="../matrix/">Matrix</a>
</li>
<li>
<a class="dropdown-item" href="../rest-api/">REST api</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Developer Guide <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../requirements/">Requirements</a>
</li>
<li>
<a class="dropdown-item" href="../internal/build/">Build</a>
</li>
<li>
<a class="dropdown-item" href="../internal/junit5/">JUnit5</a>
</li>
<li>
<a class="dropdown-item" href="../internal/mkdocs/">Mkdocs</a>
</li>
<li>
<a class="dropdown-item" href="../internal/cli/">CLI</a>
</li>
<li>
<a class="dropdown-item" href="../internal/finishing-a-milestone/">Finishing a milestone</a>
</li>
<li>
<a class="dropdown-item" href="../internal/implementing-a-new-task/">Implementing a new task</a>
</li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" data-target="#mkdocs_search_modal" data-toggle="modal" href="#">
<i class="fa fa-search"></i> Search
                            </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../docker-image/" rel="prev">
<i class="fa fa-arrow-left"></i> Previous
                                </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../copy-file/" rel="next">
                                    Next <i class="fa fa-arrow-right"></i>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://github.com/thomas-lehmann-private/hyperion-task-processor/edit/master/docs/docker-container.md"><i class="fa fa-github"></i> Edit on GitHub</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
<li class="nav-item" data-level="1"><a class="nav-link" href="#docker-container-task">Docker container task</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="2"><a class="nav-link" href="#the-minimal-example">The minimal example</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#running-detached">Running detached</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#minimal-example-with-tags">Minimal example with tags</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#example-with-variable">Example with variable</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#example-with-templating">Example with templating</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<h1 id="docker-container-task">Docker container task</h1>
<p>This doesn't intend to explain Docker. Please refer to official Docker
documentation for details on it. It's about the Docker container task.
The docker container does offer  <a href="../basic-coded-task-features/">basic coded task features</a> 
. In addition following attributes are available:</p>
<ul>
<li><strong>image-name</strong> - the mandatory attribute specifies the name of the docker image to use</li>
<li><strong>image-version</strong> - the optional string attribute specifies the version of the docker image to use.
   If not specified the default is <strong>latest</strong>.</li>
<li><strong>detached</strong> - the optional boolean attribute specified whether to run the docker container
   in detached (background) mode. If not specified the default is <strong>false</strong>.</li>
<li><strong>platform</strong> - the optional parameter for what kind of Docker container to run.
   If not specified the Default is <strong>unix</strong> (read a bit later about platform).
   It does have the effect that the generated temporary script - that will be executed
   by the Docker container - is either passed to <strong>cmd /c</strong> or <strong>sh -c</strong>.</li>
</ul>
<p>A few things to mention here about Docker:</p>
<ul>
<li>Docker is an external tool that must exist otherwise you cannot
   use the task; even more the Hyperion tool will throw an error
   when the Docker tool has not been found.</li>
<li>The default is to run Docker container with Unix images. On Windows you are
   able to switch to Windows container so you could run Windows batch code inside
   the Docker container. Usually you can switch to either use the one platform or
   the other platform but not both at same time. From documentation, it seems an
   experimental feature that can be turned on allowing you to specify the
   parameter <strong>--platform</strong> with the values <strong>windows</strong> or <strong>unix</strong> so you could
   use both at same time. Since it is experimental and I cannot rely on yet that this
   is turned on by default I don't generate that parameter; means you cannot
   use both at same time for now.</li>
<li>Also on Windows you have to be aware that sharing a drive is to be adjusted in
   the settings of Docker. Be aware that right now Hyperion differs two mounts which
   are currently done automatically:<ul>
<li>the mount of the current working directory (as /work)</li>
<li>the mount of the path usually used for generating temporary files and folders
  by the standard Java API. At least it means <strong>you might have to allow more than
  one Windows drive to be shared with the Docker container</strong>. Since you probably
  want to run Hyperion processing automatically it is advisable to adjust this in
  advance otherwise the Docker process is trying to ask you via Dialog.</li>
</ul>
</li>
</ul>
<h2 id="the-minimal-example">The minimal example</h2>
<p>It's really easy and doesn't differ much from other task. Following details:</p>
<pre><code class="language-yaml">---
taskgroups:
  - title: test
    tasks:
      - type: docker-container
        code: echo "hello world!"
        image-name: debian
</code></pre>
<h2 id="running-detached">Running detached</h2>
<p>It's nothing you would do in a real environment but that simple example demonstrates
how it does work:</p>
<ul>
<li>After running you can do a "docker ps -a" and you will see the container running.</li>
<li>After 30 seconds the container will automatically go away since --rm is also used.</li>
</ul>
<p>You can use this for running a Database or an application server in it.
The variable (also not specified here) will contain the id of the container that can
be used to work on the container (example: using the id to stop the container).</p>
<pre><code class="language-yaml">---
taskgroups:
  - title: test
    tasks:
      - type: docker-container
        code: sleep 30
        image-name: debian
        detached: true
</code></pre>
<h2 id="minimal-example-with-tags">Minimal example with tags</h2>
<p>The application can be called with the repeatable option --tag. Specifying the
those filter task will be executed only contain those tags. Task with other tags
or even without any tags will be ignored then.</p>
<pre><code class="language-yaml">---
taskgroups:
  - title: test
    tasks:
      - type: docker-container
        code: echo "hello world!"
        image-name: debian
        tags:
          - simple
          - example         
</code></pre>
<h2 id="example-with-variable">Example with variable</h2>
<p>The example with variable shows how to use the variable to extract information.
It's exactly the same way as it does work for other tasks.
You can specify the regex for filtering and - if required - the regex group;
the default group is 0.</p>
<pre><code class="language-yaml">---
taskgroups:
  - title: test
    tasks:
        - type: docker-container
          title: a simple example
          code: echo "---&gt; this is a demo &lt;---"
          image-name: debian
          variable:
              name: test2
              regex: "&gt;(.*)&lt;"
              group: 1
</code></pre>
<h2 id="example-with-templating">Example with templating</h2>
<p>The task group does store a map of key/value where key is the name of the variable, and
the value is a variable. If you do not specify a name for a variable the name is
'<strong>default</strong>'. In the following example the first task does write 'hello world!' into
the variable, and the second task does evaluate the value from the first task.
Of course the second one write into the same variable its output since also there
no name has been specified.</p>
<pre><code class="language-yaml">---
taskgroups:
  - title: test
    tasks:
      - type: docker-container
        title: a simple example 1
        code: echo "hello world!"
        docker-image: debian
      - type: dockier-container
        title: a simple example 2
        code: echo "{{ variables.default.value }}"
        docker-image: debian
</code></pre>
<p>In addition, you can evaluate the model if you have one.</p>
<pre><code class="language-yaml">---
model:
  description: some description

taskgroups:
  - title: test
    tasks:
      - type: docker-container
        title: a simple example 1
        code: echo "{{ model.attributest.description }}"
        docker-image: debian
</code></pre>
<p>The rules on how to access the individual elements of a model are
explained <a href="../templating/">here</a>.</p></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script defer="" src="../js/base.js"></script>
<script defer="" src="../search/main.js"></script>
<div aria-hidden="true" aria-labelledby="searchModalLabel" class="modal" id="mkdocs_search_modal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="searchModalLabel">Search</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<p>From here you can search these documents. Enter your search terms below.</p>
<form>
<div class="form-group">
<input class="form-control" id="mkdocs-search-query" placeholder="Search..." title="Type search term here" type="search"/>
</div>
</form>
<div data-no-results-text="No results found" id="mkdocs-search-results"></div>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div><div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
</body>
</html>
